<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>PICC ä»»å‹™å»ºç«‹</title>

  <!-- LINE LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", Arial, sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 420px;
      margin: 60px auto;
      background: #ffffff;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      margin-bottom: 24px;
    }

    label {
      display: block;
      margin-top: 16px;
      font-weight: bold;
    }

    input {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    button {
      margin-top: 24px;
      width: 100%;
      padding: 14px;
      background-color: #06c755;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
    }

    button:active {
      opacity: 0.9;
    }

    .hint {
      margin-top: 12px;
      color: #888;
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>PICC ä»»å‹™å»ºç«‹</h1>

    <label for="bed">åºŠè™Ÿ</label>
    <input id="bed" placeholder="ä¾‹å¦‚ï¼š12A" />

    <label for="mrn">ç—…æ­·è™Ÿ</label>
    <input id="mrn" placeholder="ä¾‹å¦‚ï¼š12345678" />

    <label for="name">ç—…äººå§“å</label>
    <input id="name" placeholder="ä¾‹å¦‚ï¼šç‹å¤§æ˜" />

    <button onclick="submitForm()">é€å‡º</button>

    <div class="hint">è«‹æ–¼ LINE App å…§é–‹å•Ÿ</div>
  </div>

  <script>
    // ğŸ”´ æ›æˆä½ è‡ªå·±çš„ LIFF ID
    const LIFF_ID = "2008960440-PK37CLiF";

    async function initLIFF() {
      try {
        await liff.init({ liffId: LIFF_ID });

        // âš ï¸ åªåœ¨ã€Œä¸æ˜¯ç™»å…¥ç‹€æ…‹ã€æ™‚æ‰ç™»å…¥
        if (!liff.isLoggedIn()) {
          liff.login({
            redirectUri: window.location.href
          });
          return;
        }

        console.log("LIFF åˆå§‹åŒ–å®Œæˆï¼Œå·²ç™»å…¥");

      } catch (err) {
        console.error("LIFF åˆå§‹åŒ–å¤±æ•—", err);
        alert("LIFF åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹ç¢ºèªæ˜¯å¦åœ¨ LINE App å…§é–‹å•Ÿ");
      }
    }

    function submitForm() {
      const bed = document.getElementById("bed").value.trim();
      const mrn = document.getElementById("mrn").value.trim();
      const name = document.getElementById("name").value.trim();

      if (!bed || !mrn || !name) {
        alert("è«‹å®Œæ•´å¡«å¯«æ‰€æœ‰æ¬„ä½");
        return;
      }

      const data = {
        bed,
        mrn,
        name,
        userId: liff.getContext()?.userId || "unknown"
      };

      console.log("é€å‡ºè³‡æ–™ï¼š", data);

      alert("è¡¨å–®é€å‡ºæˆåŠŸï¼ˆç›®å‰åƒ…ç¤ºç¯„ï¼Œå°šæœªæ¥å¾Œç«¯ï¼‰");

      // å¦‚æœä½ ä¹‹å¾Œè¦é—œé–‰ LIFF
      // liff.closeWindow();
    }

    // ğŸš€ å•Ÿå‹• LIFF
    initLIFF();
  </script>
</body>
</html>
